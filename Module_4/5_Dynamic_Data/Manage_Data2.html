<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"/>
        <title>News</title>
    </head>
    <body>
<!--html template-->
        <template id="news-template">
            <div class="col-12 col-md-6 col-lg-3">
                <div class="card h-100" style="margin:10px">
                <div class="card-body">
                        <h5 class="news-title">News title</h5>
                        <p class="news-content card-text"></p> 
                    </div>
                </div>    
            </div>
        </template>
<!-- form-->        
        <form onsubmit="onSubmitClick(event)"> 
            <div>
                <label>Title</label>
                <input name="title" id="formTitle" />
                <label>Text</label>
                <input name="content" id="formContent" />
                <button type="submit">Save</button>
            </div>
        </form>

        <button onclick="stopInterval()">Stop</button> <!--Stop: calls stopInterval() to stop the auto-refresh-->

        <div class="container my-4">
            <div id="news-list" class="row g-3"></div> 
            
        </div>

        <script>
            let news = [ 
                { id: 1, title: 'Election Results', content: "Newly elected minister..." },
                { id: 2, title: 'Sporting Success', content: "World Cup winners..." },
                { id: 3, title: 'Tornado Warning', content: "Residents should prepare..." }
            ];

            function getNews() {
                return new Promise((resolve) => { 
                setTimeout(() => resolve(news), 200);
                });
            }

            function addNews(item) {
                const template = document.getElementById("news-template").content.cloneNode(true); 
                template.querySelector(".news-title").innerText = item.title;
                template.querySelector(".news-content").innerText = item.content;
                document.querySelector("#news-list").appendChild(template); 
            }

            function renderNews(items) {
                const list = document.getElementById('news-list');
                list.replaceChildren(); 
                items.forEach(addNews);
            }
            getNews().then(renderNews);

            let refreshId = setInterval(async () => {
                const items = await getNews();
                renderNews(items); 
            }, 5000);

            function onSubmitClick(event) {
                event.preventDefault();
                const title = document.getElementById('formTitle').value
                const content = document.getElementById('formContent').value

                news.push({
                  id: news.length + 1,
                  title: title,
                  content: content
                });
              document.getElementById('formTitle').value = ""
              document.getElementById('formContent').value = ""
            }

            function stopInterval() {
              clearInterval(refreshId)
            }
        </script>
    </body>
</html>